(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{74483:function(e,a,s){Promise.resolve().then(s.bind(s,79356))},79356:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return W}});var t=s(3827),r=s(64090),l=s(8792),i=s(47907),n=s(85754),o=s(45179),d=s(55211),c=s(77326),m=s(79744),h=s(28670),x=s(52235),f=s(27815),u=s(65400),g=s(28877),p=s(79949),y=s(31047),j=s(72891),N=s(64848),v=s(93930);function b(){let{setTheme:e}=(0,N.F)();return(0,t.jsxs)(v.h_,{children:[(0,t.jsx)(v.$F,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"outline",size:"icon",className:"border-gray-600 hover:bg-gray-700",children:[(0,t.jsx)(y.Z,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,t.jsx)(j.Z,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,t.jsxs)(v.AW,{align:"end",className:"bg-gray-800 border-gray-700",children:[(0,t.jsx)(v.Xi,{onClick:()=>e("light"),className:"text-gray-300 hover:text-gray-100 hover:bg-gray-700",children:"Light"}),(0,t.jsx)(v.Xi,{onClick:()=>e("dark"),className:"text-gray-300 hover:text-gray-100 hover:bg-gray-700",children:"Dark"}),(0,t.jsx)(v.Xi,{onClick:()=>e("system"),className:"text-gray-300 hover:text-gray-100 hover:bg-gray-700",children:"System"})]})]})}function w(e){let{children:a,...s}=e;return(0,t.jsx)(N.f,{...s,children:a})}var k=s(5423),C=s(34059),S=s(97307),z=s(90684),Z=s(4697),E=s(29910),_=s(81049),O=s(43345),I=s(57427),T=s(1657);let R=I.fC,V=I.xz,L=r.forwardRef((e,a)=>{let{className:s,align:r="center",sideOffset:l=4,...i}=e;return(0,t.jsx)(I.h_,{children:(0,t.jsx)(I.VY,{ref:a,align:r,sideOffset:l,className:(0,T.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});L.displayName=I.VY.displayName;var F=s(19346);let M=r.forwardRef((e,a)=>{let{className:s,children:r,...l}=e;return(0,t.jsxs)(F.fC,{ref:a,className:(0,T.cn)("relative overflow-hidden",s),...l,children:[(0,t.jsx)(F.l_,{className:"h-full w-full rounded-[inherit]",children:r}),(0,t.jsx)(D,{}),(0,t.jsx)(F.Ns,{})]})});M.displayName=F.fC.displayName;let D=r.forwardRef((e,a)=>{let{className:s,orientation:r="vertical",...l}=e;return(0,t.jsx)(F.gb,{ref:a,orientation:r,className:(0,T.cn)("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...l,children:(0,t.jsx)(F.q4,{className:"relative flex-1 rounded-full bg-border"})})});D.displayName=F.gb.displayName;var H=s(47788),J=s(25890),Y=s(28745);function A(){let[e,a]=(0,r.useState)([]),[s,l]=(0,r.useState)(!1),{toast:i}=(0,H.pm)(),o=async()=>{try{let e=localStorage.getItem("user");if(!e)return;let s=JSON.parse(e),t=await fetch("/api/notifications?userId=".concat(s._id)),r=await t.json();if(!t.ok)throw Error();a(r)}catch(e){console.error("Error fetching notifications:",e)}};(0,r.useEffect)(()=>{o();let e=setInterval(o,3e4);return()=>clearInterval(e)},[]);let d=async e=>{try{if(!(await fetch("/api/notifications",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationId:e})})).ok)throw Error();a(a=>a.filter(a=>a._id!==e))}catch(e){i({variant:"destructive",title:"Error",description:"Failed to mark notification as read"})}};return(0,t.jsxs)(R,{open:s,onOpenChange:l,children:[(0,t.jsx)(V,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(O.Z,{className:"h-5 w-5"}),e.length>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white",children:e.length})]})}),(0,t.jsxs)(L,{className:"w-80 p-0",align:"end",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsx)("h4",{className:"text-sm font-semibold",children:"Notifications"})}),(0,t.jsx)(M,{className:"h-[300px]",children:(0,t.jsx)(Y.M,{mode:"popLayout",children:0===e.length?(0,t.jsx)("div",{className:"p-4 text-center text-sm text-gray-500",children:"No new notifications"}):e.map(e=>(0,t.jsx)(p.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"p-4 border-b last:border-0",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:(0,J.WU)(new Date(e.createdAt),"MMM dd, yyyy HH:mm")})]}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>d(e._id),className:"text-xs",children:"Mark as read"})]})},e._id))})})]})]})}var P=s(50660),U=s(99812),X=s(42706);let q=[{name:"Dashboard",href:"/user/dashboard",icon:k.Z,permission:"dashboard"},{name:"Leads",href:"/user/leads",icon:C.Z,permission:"leads"},{name:"Calendar",href:"/user/calendar",icon:S.Z,permission:"calendar"},{name:"Email",href:"/user/email",icon:z.Z,permission:"email"},{name:"Inventory",href:"/user/inventory",icon:Z.Z,permission:"inventory"},{name:"Settings",href:"/user/settings",icon:E.Z,permission:"settings"},{name:"Favorites",href:"/user/favorites",icon:d.Z,permission:"favorites"},{name:"MLS",href:"/user/mls",icon:c.Z,permission:"mls"}];function W(e){var a;let{children:s}=e,d=(0,i.usePathname)(),c=(0,i.useRouter)(),[y,j]=(0,r.useState)(""),[N,k]=(0,r.useState)([]),[C,S]=(0,r.useState)(!1),[z,Z]=(0,r.useState)(null),[O,I]=(0,r.useState)(null),[T,R]=(0,r.useState)(!1),[V,L]=(0,r.useState)(!1),[F,M]=(0,r.useState)(!1),[D,H]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let a=JSON.parse(e);Z(a),I(a.permissions)}else c.push("/login")},[c]),(0,r.useEffect)(()=>{R(!0)},[]);let J=e=>{if(j(e),!e.trim()){k([]),S(!1);return}S(!0),k(g.c.search(e))},Y=()=>{j(""),k([]),S(!1)},W=e=>{c.push(e.link),Y()},$=async e=>{try{if(!(await fetch("/api/users/".concat(z._id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({avatar:e})})).ok)throw Error("Failed to update avatar");let a={...z,avatar:e};localStorage.setItem("user",JSON.stringify(a)),Z(a)}catch(e){throw console.error("Error updating avatar:",e),e}},G=()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),document.cookie="user=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",c.push("/")},K=()=>(0,t.jsxs)("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-gray-800 px-6 ring-1 ring-white/5",children:[(0,t.jsx)("div",{className:"flex h-16 shrink-0 items-center",children:(0,t.jsxs)(l.default,{href:"/user/dashboard",className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-red-500",children:"GetHome"}),(0,t.jsx)("span",{className:"ml-2 text-xl font-semibold text-gray-200",children:"Realty"})]})}),(0,t.jsx)("nav",{className:"flex flex-1 flex-col",children:(0,t.jsxs)("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:[(0,t.jsx)("li",{children:(0,t.jsx)("ul",{role:"list",className:"-mx-2 space-y-1",children:q.map(e=>{if(!O[e.permission])return null;let a=d===e.href;return(0,t.jsx)(p.E.li,{whileHover:{x:4},children:(0,t.jsxs)(l.default,{href:e.href,className:"\n                                group flex gap-x-3 rounded-md p-2 text-sm leading-6\n                                ".concat(a?"bg-gray-700 text-red-500":"text-gray-400 hover:text-red-500 hover:bg-gray-700","\n                              "),onClick:()=>M(!1),children:[(0,t.jsx)(e.icon,{className:"h-6 w-6 shrink-0 ".concat(a?"text-red-500":"text-gray-400 group-hover:text-red-500"),"aria-hidden":"true"}),e.name]})},e.name)})})}),(0,t.jsx)("li",{className:"mt-auto",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(b,{}),(0,t.jsxs)(n.z,{variant:"ghost",className:"group -mx-2 flex gap-x-3 rounded-md p-2 text-sm font-semibold leading-6 text-gray-400 hover:bg-gray-700 hover:text-red-500",onClick:G,children:[(0,t.jsx)(_.Z,{className:"h-6 w-6 shrink-0 text-gray-400 group-hover:text-red-500","aria-hidden":"true"}),"Logout"]})]})})]})})]});return z&&O&&T?(0,t.jsx)(w,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,storageKey:"user-theme-preference",children:(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"hidden md:fixed md:inset-y-0 md:z-50 md:flex md:w-72 md:flex-col",children:(0,t.jsx)(K,{})}),(0,t.jsx)(u.yo,{open:F,onOpenChange:M,children:(0,t.jsx)(u.ue,{side:"left",className:"w-72 p-0",children:(0,t.jsx)(K,{})})}),(0,t.jsxs)("div",{className:"w-full md:pl-72",children:[(0,t.jsxs)("header",{className:"sticky top-0 z-30 flex h-16 items-center justify-between border-b border-gray-800 bg-gray-800/95 backdrop-blur px-4 md:px-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-4 md:hidden",children:(0,t.jsx)(n.z,{variant:"ghost",size:"icon",onClick:()=>M(!0),children:(0,t.jsx)(m.Z,{className:"h-6 w-6 text-gray-400"})})}),(0,t.jsx)("div",{className:"hidden md:flex md:flex-1 md:items-center md:gap-4",children:(0,t.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,t.jsx)(h.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),(0,t.jsx)(o.I,{type:"search",placeholder:"Search...",className:"w-full pl-8 bg-gray-700/50 border-gray-600 text-gray-100 focus:bg-gray-700",value:y,onChange:e=>J(e.target.value)}),y&&(0,t.jsx)(n.z,{variant:"ghost",size:"icon",className:"absolute right-1 top-1 h-7 w-7 text-gray-400 hover:text-gray-100",onClick:Y,children:(0,t.jsx)(x.Z,{className:"h-4 w-4"})}),C&&N.length>0&&(0,t.jsx)(f.Zb,{className:"absolute top-full left-0 w-full mt-2 bg-gray-800 border-gray-700",children:(0,t.jsx)(f.aY,{className:"p-2",children:N.map(e=>(0,t.jsx)(n.z,{variant:"ghost",className:"w-full justify-start text-left px-2 py-1.5 text-gray-100 hover:bg-gray-700",onClick:()=>W(e),children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:e.subtitle})]})},"".concat(e.type,"-").concat(e.id)))})})]})}),(0,t.jsx)(n.z,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>H(!D),children:(0,t.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(A,{}),(0,t.jsxs)(v.h_,{children:[(0,t.jsx)(v.$F,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"ghost",className:"flex items-center gap-2 text-gray-100 hover:text-gray-300",children:[(0,t.jsxs)(P.qE,{className:"h-8 w-8",children:[(0,t.jsx)(P.F$,{src:null==z?void 0:z.avatar,alt:null==z?void 0:z.name}),(0,t.jsx)(P.Q5,{children:null==z?void 0:null===(a=z.name)||void 0===a?void 0:a.substring(0,2).toUpperCase()})]}),(0,t.jsx)("span",{className:"hidden md:inline-block",children:null==z?void 0:z.name})]})}),(0,t.jsxs)(v.AW,{align:"end",className:"w-56",children:[(0,t.jsxs)(v.Xi,{onClick:()=>L(!0),children:[(0,t.jsx)(E.Z,{className:"mr-2 h-4 w-4"}),"Profile Settings"]}),(0,t.jsx)(v.VD,{}),(0,t.jsxs)(v.Xi,{onClick:G,children:[(0,t.jsx)(_.Z,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]})]})]}),D&&(0,t.jsxs)("div",{className:"p-4 border-b border-gray-800 md:hidden",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(h.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),(0,t.jsx)(o.I,{type:"search",placeholder:"Search...",className:"w-full pl-8 bg-gray-700/50 border-gray-600 text-gray-100 focus:bg-gray-700",value:y,onChange:e=>J(e.target.value)}),y&&(0,t.jsx)(n.z,{variant:"ghost",size:"icon",className:"absolute right-1 top-1 h-7 w-7 text-gray-400 hover:text-gray-100",onClick:Y,children:(0,t.jsx)(x.Z,{className:"h-4 w-4"})})]}),C&&N.length>0&&(0,t.jsx)(f.Zb,{className:"mt-2 bg-gray-800 border-gray-700",children:(0,t.jsx)(f.aY,{className:"p-2",children:N.map(e=>(0,t.jsx)(n.z,{variant:"ghost",className:"w-full justify-start text-left px-2 py-1.5 text-gray-100 hover:bg-gray-700",onClick:()=>{W(e),H(!1)},children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:e.subtitle})]})},"".concat(e.type,"-").concat(e.id)))})})]}),(0,t.jsx)("main",{className:"flex-1 overflow-auto p-4 md:p-6",children:s})]})]}),z&&(0,t.jsx)(X.Vq,{open:V,onOpenChange:L,children:(0,t.jsx)(X.cZ,{className:"sm:max-w-[425px]",children:(0,t.jsx)(U.L,{user:z,onUpdateAvatar:$})})})]})}):(0,t.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-900",children:(0,t.jsx)("div",{className:"text-gray-100",children:"Loading..."})})}},65400:function(e,a,s){"use strict";s.d(a,{Tu:function(){return u},aM:function(){return c},bC:function(){return g},ue:function(){return f},yo:function(){return d}});var t=s(3827),r=s(64090),l=s(72936),i=s(49769),n=s(52235),o=s(1657);let d=l.fC,c=l.xz;l.x8;let m=l.h_,h=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:a})});h.displayName=l.aV.displayName;let x=(0,i.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=r.forwardRef((e,a)=>{let{side:s="right",className:r,children:i,...d}=e;return(0,t.jsxs)(m,{children:[(0,t.jsx)(h,{}),(0,t.jsxs)(l.VY,{ref:a,className:(0,o.cn)(x({side:s}),r),...d,children:[i,(0,t.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,t.jsx)(n.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=l.VY.displayName;let u=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...s})};u.displayName="SheetHeader";let g=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.Dx,{ref:a,className:(0,o.cn)("text-lg font-semibold text-foreground",s),...r})});g.displayName=l.Dx.displayName,r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(l.dk,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",s),...r})}).displayName=l.dk.displayName}},function(e){e.O(0,[6860,9593,8792,162,4885,9949,7240,4011,2971,8069,1744],function(){return e(e.s=74483)}),_N_E=e.O()}]);