(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6723],{4336:function(e,a,s){Promise.resolve().then(s.bind(s,27153))},27153:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return E}});var t=s(3827),l=s(64090),r=s(47907),i=s(26863),n=s(27815),d=s(85754),c=s(45179),o=s(49842),u=s(23444),h=s(45509),p=s(47788),m=s(53879),x=s(70699),v=s(85904),f=s(70094),y=s(1657),j=s(42706);function g(e){let{calls:a=[]}=e,[s,r]=(0,l.useState)(!1),i=e=>{try{return"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0"))}catch(e){return console.error("Error formatting duration:",e),"0:00"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>r(!0),children:"View Call History"}),(0,t.jsx)(j.Vq,{open:s,onOpenChange:r,children:(0,t.jsxs)(j.cZ,{children:[(0,t.jsx)(j.fK,{children:(0,t.jsx)(j.$N,{children:"Call History"})}),(0,t.jsx)("div",{className:"space-y-4",children:0===a.length?(0,t.jsx)("p",{className:"text-center text-gray-500",children:"No calls recorded yet"}):a.map((e,a)=>(0,t.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:(0,y.p)(e.date,"MMM d, yyyy h:mm a")}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Duration: ",i(e.duration)]})]}),e.recording&&(0,t.jsx)(d.z,{variant:"outline",size:"sm",children:"Play Recording"})]},a))})]})})]})}var b=s(97658);function N(e){let{showings:a,onAddShowing:s}=e,[r,i]=(0,l.useState)(!1),[n,h]=(0,l.useState)(),[m,x]=(0,l.useState)({status:"scheduled"}),{toast:v}=(0,p.pm)(),y=e=>a.filter(a=>new Date(a.date).toDateString()===e.toDateString());return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Showings"}),(0,t.jsxs)(j.Vq,{open:r,onOpenChange:i,children:[(0,t.jsx)(j.hg,{asChild:!0,children:(0,t.jsxs)(d.z,{size:"sm",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Add Showing"]})}),(0,t.jsxs)(j.cZ,{children:[(0,t.jsx)(j.fK,{children:(0,t.jsx)(j.$N,{children:"Schedule a Showing"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Date"}),(0,t.jsx)(b.f,{mode:"single",selected:n,onSelect:h,className:"rounded-md border"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Time"}),(0,t.jsx)(c.I,{type:"time",value:m.time,onChange:e=>x({...m,time:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Property"}),(0,t.jsx)(c.I,{value:m.property,onChange:e=>x({...m,property:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Notes"}),(0,t.jsx)(u.g,{value:m.notes,onChange:e=>x({...m,notes:e.target.value})})]}),(0,t.jsx)(d.z,{onClick:()=>{if(!n||!m.time||!m.property){v({variant:"destructive",title:"Error",description:"Please fill in all required fields"});return}s({id:crypto.randomUUID(),date:n,time:m.time,property:m.property,notes:m.notes,status:"scheduled"}),i(!1),x({status:"scheduled"}),h(void 0),v({title:"Success",description:"Showing scheduled successfully"})},className:"w-full",children:"Schedule Showing"})]})]})]})]}),(0,t.jsx)(b.f,{mode:"single",className:"rounded-md border",modifiers:{hasShowing:e=>y(e).length>0},modifiersStyles:{hasShowing:{backgroundColor:"var(--primary)",color:"white"}}})]})}var w=s(19175),k=s(37501),S=s(59886);function C(e){let{tasks:a,onAddTask:s,onUpdateTask:r}=e,[i,n]=(0,l.useState)(!1),[h,m]=(0,l.useState)({status:"pending",priority:"medium",date:""}),{toast:x}=(0,p.pm)(),v=e=>{switch(e){case"high":return"text-red-500";case"medium":return"text-yellow-500";case"low":return"text-green-500";default:return"text-gray-500"}},y=e=>new Date(e).toLocaleDateString();return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Tasks"}),(0,t.jsxs)(j.Vq,{open:i,onOpenChange:n,children:[(0,t.jsx)(j.hg,{asChild:!0,children:(0,t.jsxs)(d.z,{size:"sm",children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Add Task"]})}),(0,t.jsxs)(j.cZ,{children:[(0,t.jsx)(j.fK,{children:(0,t.jsx)(j.$N,{children:"Add New Task"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Title"}),(0,t.jsx)(c.I,{value:h.title,onChange:e=>m({...h,title:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Date"}),(0,t.jsx)(c.I,{type:"date",value:h.date,onChange:e=>m({...h,date:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Priority"}),(0,t.jsxs)("select",{className:"w-full rounded-md border border-input bg-background px-3 py-2",value:h.priority,onChange:e=>m({...h,priority:e.target.value}),children:[(0,t.jsx)("option",{value:"low",children:"Low"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"high",children:"High"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Description"}),(0,t.jsx)(u.g,{value:h.description,onChange:e=>m({...h,description:e.target.value})})]}),(0,t.jsx)(d.z,{onClick:()=>{if(!h.title||!h.date){x({variant:"destructive",title:"Error",description:"Please fill in all required fields"});return}s({id:crypto.randomUUID(),title:h.title,date:h.date,description:h.description,status:"pending",priority:h.priority||"medium"}),n(!1),m({status:"pending",priority:"medium",date:""}),x({title:"Success",description:"Task added successfully"})},className:"w-full",children:"Add Task"})]})]})]})]}),(0,t.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>r(e.id,{status:"completed"===e.status?"pending":"completed"}),children:"completed"===e.status?(0,t.jsx)(w.Z,{className:"h-5 w-5 text-green-500"}):(0,t.jsx)(k.Z,{className:"h-5 w-5 text-gray-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.title}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[y(e.date)," â€¢ ",(0,t.jsx)("span",{className:v(e.priority),children:e.priority})]})]})]}),(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>r(e.id,{status:"cancelled"}),children:(0,t.jsx)(S.Z,{className:"h-5 w-5 text-red-500"})})]},e.id))})]})}let P=[{value:"cold",label:"Cold"},{value:"warm",label:"Warm"},{value:"hot",label:"Hot"},{value:"mild",label:"Mild"}],_=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"not answering",label:"Not Answering"},{value:"not actively answering",label:"Not Actively Answering"},{value:"always responding",label:"Always Responding"}],T=[{value:"google ads",label:"Google Ads"},{value:"meta",label:"Meta"},{value:"refferal",label:"Refferal"},{value:"linkedin",label:"LinkedIn"},{value:"youtube",label:"YouTube"}],I=[{value:"Pre construction",label:"Pre Construction"},{value:"resale",label:"Resale"},{value:"seller",label:"Seller"},{value:"buyer",label:"Buyer"}],Z=[{value:"Investor",label:"Investor"},{value:"custom buyer",label:"Custom Buyer"},{value:"first home buyer",label:"First Home Buyer"},{value:"seasonal investor",label:"Seasonal Investor"},{value:"commercial buyer",label:"Commercial Buyer"}],z=[{value:"downtown",label:"Downtown"},{value:"north_york",label:"North York"},{value:"scarborough",label:"Scarborough"},{value:"etobicoke",label:"Etobicoke"},{value:"mississauga",label:"Mississauga"},{value:"brampton",label:"Brampton"},{value:"markham",label:"Markham"},{value:"vaughan",label:"Vaughan"}];function E(){var e,a,s,j,b,w,k;let S=(0,r.useRouter)(),E=(0,r.useParams)(),{toast:D}=(0,p.pm)(),[A,M]=(0,l.useState)(null),[O,R]=(0,l.useState)(!1),[F,H]=(0,l.useState)(""),[V,B]=(0,l.useState)([]);(0,l.useEffect)(()=>{(null==E?void 0:E.leadId)&&(L(),U())},[null==E?void 0:E.leadId]);let L=async()=>{try{if(!(null==E?void 0:E.leadId))return;let e=E.leadId;if(!e)return;console.log("Fetching lead with ID:",e);let a=await fetch("/api/leads/".concat(e)),s=await a.json();if(!a.ok)throw console.error("Error response:",s),Error(s.error||"Failed to fetch lead");console.log("Fetched lead data:",s),M(s)}catch(e){console.error("Fetch lead error:",e),D({variant:"destructive",title:"Error",description:"Failed to fetch lead details"}),S.push("/lead")}},U=async()=>{try{let e=await fetch("/api/users"),a=await e.json();B(a)}catch(e){console.error("Error fetching users:",e),D({variant:"destructive",title:"Error",description:"Failed to fetch users"})}},Q=async()=>{if(A&&(null==E?void 0:E.leadId)){R(!0);try{if(!(await fetch("/api/leads/".concat(E.leadId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)})).ok)throw Error("Failed to update lead");window.dispatchEvent(new Event("leadUpdated")),D({title:"Success",description:"Lead updated successfully"})}catch(e){console.error("Update lead error:",e),D({variant:"destructive",title:"Error",description:"Failed to update lead"})}finally{R(!1)}}},Y=async(e,a)=>{if(A&&(null==E?void 0:E.leadId))try{let s=[...A.callHistory||[]];s[e].points||(s[e].points=[]),s[e].points.push({text:a,timestamp:new Date().toISOString()});let t={...A,callHistory:s};if(M(t),!(await fetch("/api/leads/".concat(E.leadId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({callHistory:s})})).ok)throw Error("Failed to save call point");D({title:"Success",description:"Call point added successfully"})}catch(e){D({variant:"destructive",title:"Error",description:"Failed to add call point"})}},q=async()=>{if(F.trim()&&A&&(null==E?void 0:E.leadId))try{console.log("Adding note for lead:",E.leadId);let e=new Date().toISOString(),a=A.notes?"".concat(A.notes,"\n\n").concat(e,": ").concat(F):"".concat(e,": ").concat(F),s=await fetch("/api/leads/".concat(E.leadId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:a})}),t=await s.json();if(console.log("Response from server:",t),!s.ok)throw Error(t.error||"Failed to save note");M(t),H(""),D({title:"Success",description:"Note added successfully"})}catch(e){console.error("Save note error:",e),D({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Failed to save note"})}};return A?(0,t.jsx)(i.c,{children:(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(d.z,{variant:"outline",onClick:()=>S.back(),className:"border-black text-black hover:bg-black hover:text-white",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Back to Leads"]}),(0,t.jsxs)(d.z,{onClick:Q,disabled:O,className:"bg-[#ef4444] hover:bg-[#dc2626] text-white",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zb,{children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{children:"Lead Information"})}),(0,t.jsx)(n.aY,{children:(0,t.jsxs)("form",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Name"}),(0,t.jsx)(c.I,{value:A.name,onChange:e=>M({...A,name:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Email"}),(0,t.jsx)(c.I,{type:"email",value:A.email,onChange:e=>M({...A,email:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Phone"}),(0,t.jsx)(c.I,{value:A.phone,onChange:e=>M({...A,phone:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Assigned To"}),(0,t.jsxs)(h.Ph,{value:A.assignedTo||"unassigned",onValueChange:e=>M({...A,assignedTo:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select a user"})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"unassigned",children:"Unassigned"}),V.map(e=>(0,t.jsx)(h.Ql,{value:e._id,children:e.name},e._id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Property"}),(0,t.jsx)(c.I,{value:A.property,onChange:e=>M({...A,property:e.target.value})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Location"}),(0,t.jsxs)(h.Ph,{value:A.location||"",onValueChange:e=>M({...A,location:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select location"})}),(0,t.jsx)(h.Bw,{children:z.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Created Date"}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:(0,y.p)(A.date)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Lead Status"}),(0,t.jsxs)(h.Ph,{value:A.leadStatus,onValueChange:e=>M({...A,leadStatus:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select lead status"})}),(0,t.jsx)(h.Bw,{children:P.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Lead Response"}),(0,t.jsxs)(h.Ph,{value:A.leadResponse,onValueChange:e=>M({...A,leadResponse:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select lead response"})}),(0,t.jsx)(h.Bw,{children:_.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Lead Source"}),(0,t.jsxs)(h.Ph,{value:A.leadSource,onValueChange:e=>M({...A,leadSource:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select lead source"})}),(0,t.jsx)(h.Bw,{children:T.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Lead Type"}),(0,t.jsxs)(h.Ph,{value:A.leadType,onValueChange:e=>M({...A,leadType:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select lead type"})}),(0,t.jsx)(h.Bw,{children:I.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Client Type"}),(0,t.jsxs)(h.Ph,{value:A.clientType,onValueChange:e=>M({...A,clientType:e}),children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select client type"})}),(0,t.jsx)(h.Bw,{children:Z.map(e=>(0,t.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]})]})]})})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(n.Zb,{children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{children:"Communication"})}),(0,t.jsxs)(n.aY,{className:"space-y-4",children:[(0,t.jsxs)(d.z,{className:"w-full",onClick:()=>{if(!(null==A?void 0:A.phone))return;let e=new Date().toISOString(),a=[...A.callHistory||[],{date:e,duration:0,recording:void 0,points:[]}];M({...A,callHistory:a}),D({title:"Calling",description:"Initiating call to ".concat(A.phone)})},children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Make Call"]}),(0,t.jsx)("div",{className:"space-y-4",children:(A.callHistory||[]).map((e,a)=>(0,t.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:["Call on ",(0,y.p)(e.date)]}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Duration: ",e.duration," minutes"]})]}),e.recording&&(0,t.jsx)(d.z,{variant:"outline",size:"sm",children:"Play Recording"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.I,{placeholder:"Add key points from the call...",onKeyDown:e=>{"Enter"===e.key&&e.target.value.trim()&&(Y(a,e.target.value.trim()),e.target.value="")}}),(0,t.jsx)(d.z,{variant:"outline",onClick:e=>{let s=e.currentTarget.previousElementSibling;s.value.trim()&&(Y(a,s.value.trim()),s.value="")},children:"Add Point"})]}),e.points&&e.points.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{className:"text-sm font-medium",children:"Key Points:"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.points.map((e,a)=>(0,t.jsxs)("li",{className:"text-sm flex items-start gap-2",children:[(0,t.jsx)("span",{className:"mt-1",children:"â€¢"}),(0,t.jsx)("span",{children:e.text})]},a))})]})]})]},a))}),(0,t.jsx)(g,{calls:A.callHistory||[]})]})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{children:"Notes"})}),(0,t.jsx)(n.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(u.g,{placeholder:"Add a new note...",value:F,onChange:e=>H(e.target.value),className:"flex-1"}),(0,t.jsxs)(d.z,{onClick:q,className:"self-start",disabled:!F.trim()||O,children:[(0,t.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Add Note"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[null==A?void 0:null===(e=A.notes)||void 0===e?void 0:e.split("\n\n").map((e,a)=>(0,t.jsx)("div",{className:"text-sm border-b pb-2",children:e},a)),!(null==A?void 0:A.notes)&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No notes yet"})]})]})})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{children:"Property Preferences"})}),(0,t.jsx)(n.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Budget Range"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(c.I,{type:"number",placeholder:"Min",value:(null===(s=A.propertyPreferences)||void 0===s?void 0:null===(a=s.budget)||void 0===a?void 0:a.min)||"",onChange:e=>{var a,s,t,l,r,i,n;return M({...A,propertyPreferences:{propertyType:(null===(a=A.propertyPreferences)||void 0===a?void 0:a.propertyType)||[],bedrooms:(null===(s=A.propertyPreferences)||void 0===s?void 0:s.bedrooms)||0,bathrooms:(null===(t=A.propertyPreferences)||void 0===t?void 0:t.bathrooms)||0,locations:(null===(l=A.propertyPreferences)||void 0===l?void 0:l.locations)||[],features:(null===(r=A.propertyPreferences)||void 0===r?void 0:r.features)||[],budget:{min:Number(e.target.value),max:(null===(n=A.propertyPreferences)||void 0===n?void 0:null===(i=n.budget)||void 0===i?void 0:i.max)||0}}})}}),(0,t.jsx)(c.I,{type:"number",placeholder:"Max",value:(null===(b=A.propertyPreferences)||void 0===b?void 0:null===(j=b.budget)||void 0===j?void 0:j.max)||"",onChange:e=>{var a,s,t,l,r,i,n;return M({...A,propertyPreferences:{propertyType:(null===(a=A.propertyPreferences)||void 0===a?void 0:a.propertyType)||[],bedrooms:(null===(s=A.propertyPreferences)||void 0===s?void 0:s.bedrooms)||0,bathrooms:(null===(t=A.propertyPreferences)||void 0===t?void 0:t.bathrooms)||0,locations:(null===(l=A.propertyPreferences)||void 0===l?void 0:l.locations)||[],features:(null===(r=A.propertyPreferences)||void 0===r?void 0:r.features)||[],budget:{min:(null===(n=A.propertyPreferences)||void 0===n?void 0:null===(i=n.budget)||void 0===i?void 0:i.min)||0,max:Number(e.target.value)}}})}})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o._,{children:"Property Type"}),(0,t.jsxs)(h.Ph,{value:(null===(k=A.propertyPreferences)||void 0===k?void 0:null===(w=k.propertyType)||void 0===w?void 0:w[0])||"",onValueChange:e=>{var a,s,t,l,r,i,n,d;return M({...A,propertyPreferences:{propertyType:[e],bedrooms:(null===(a=A.propertyPreferences)||void 0===a?void 0:a.bedrooms)||0,bathrooms:(null===(s=A.propertyPreferences)||void 0===s?void 0:s.bathrooms)||0,locations:(null===(t=A.propertyPreferences)||void 0===t?void 0:t.locations)||[],features:(null===(l=A.propertyPreferences)||void 0===l?void 0:l.features)||[],budget:{min:(null===(i=A.propertyPreferences)||void 0===i?void 0:null===(r=i.budget)||void 0===r?void 0:r.min)||0,max:(null===(d=A.propertyPreferences)||void 0===d?void 0:null===(n=d.budget)||void 0===n?void 0:n.max)||0}}})},children:[(0,t.jsx)(h.i4,{children:(0,t.jsx)(h.ki,{placeholder:"Select type"})}),(0,t.jsxs)(h.Bw,{children:[(0,t.jsx)(h.Ql,{value:"detached",children:"Detached"}),(0,t.jsx)(h.Ql,{value:"semi-detached",children:"Semi-Detached"}),(0,t.jsx)(h.Ql,{value:"townhouse",children:"Townhouse"}),(0,t.jsx)(h.Ql,{value:"condo",children:"Condo"})]})]})]})]}),(0,t.jsx)(N,{showings:A.showings||[],onAddShowing:async e=>{if(!(null==E?void 0:E.leadId))return;let a=[...A.showings||[],{...e,id:e.id||""}];M({...A,showings:a});try{if(!(await fetch("/api/leads/".concat(E.leadId),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({showings:a})})).ok)throw Error("Failed to update showings");D({title:"Success",description:"Showing scheduled successfully"})}catch(e){D({variant:"destructive",title:"Error",description:"Failed to schedule showing"})}}})]})})]}),(0,t.jsxs)(n.Zb,{className:"mt-6",children:[(0,t.jsx)(n.Ol,{children:(0,t.jsx)(n.ll,{children:"Tasks"})}),(0,t.jsx)(n.aY,{children:(0,t.jsx)(C,{tasks:A.tasks||[],onAddTask:async e=>{if(!(null==E?void 0:E.leadId))return;let a=[...A.tasks||[],e];M({...A,tasks:a});try{if(!(await fetch("/api/leads/".concat(E.leadId,"/tasks"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:a})})).ok)throw Error("Failed to add task");D({title:"Success",description:"Task added successfully"})}catch(e){D({variant:"destructive",title:"Error",description:"Failed to add task"})}},onUpdateTask:async(e,a)=>{if(null==E?void 0:E.leadId)try{var s;let t={...a,date:a.date?new Date(a.date).toISOString():void 0};if(!(await fetch("/api/leads/".concat(E.leadId,"/tasks/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to update task");let l=(null===(s=A.tasks)||void 0===s?void 0:s.map(s=>s.id===e?{...s,...a}:s))||[];M({...A,tasks:l}),D({title:"Success",description:"Task updated successfully"})}catch(e){D({variant:"destructive",title:"Error",description:"Failed to update task"})}}})})]})]})]})]})}):(0,t.jsx)(i.c,{children:(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Loading lead details..."}),(0,t.jsx)("p",{className:"text-gray-500",children:"Please wait while we fetch the information."})]})})})}},97658:function(e,a,s){"use strict";s.d(a,{f:function(){return c}});var t=s(3827);s(64090);var l=s(49108),r=s(37805),i=s(79682),n=s(1657),d=s(85754);function c(e){let{className:a,classNames:s,showOutsideDays:c=!0,...o}=e;return(0,t.jsx)(i._W,{showOutsideDays:c,className:(0,n.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,n.cn)((0,d.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,n.cn)((0,d.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{...a}=e;return(0,t.jsx)(l.Z,{className:"h-4 w-4"})},IconRight:e=>{let{...a}=e;return(0,t.jsx)(r.Z,{className:"h-4 w-4"})}},...o})}c.displayName="Calendar"},49842:function(e,a,s){"use strict";s.d(a,{_:function(){return c}});var t=s(3827),l=s(64090),r=s(24602),i=s(49769),n=s(1657);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.f,{ref:a,className:(0,n.cn)(d(),s),...l})});c.displayName=r.f.displayName},45509:function(e,a,s){"use strict";s.d(a,{Bw:function(){return x},Ph:function(){return o},Ql:function(){return v},i4:function(){return h},ki:function(){return u}});var t=s(3827),l=s(64090),r=s(2072),i=s(23441),n=s(85159),d=s(80037),c=s(1657);let o=r.fC;r.ZA;let u=r.B4,h=l.forwardRef((e,a)=>{let{className:s,children:l,...n}=e;return(0,t.jsxs)(r.xz,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[l,(0,t.jsx)(r.JO,{asChild:!0,children:(0,t.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=r.xz.displayName;let p=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.u_,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});p.displayName=r.u_.displayName;let m=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.$G,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,t.jsx)(i.Z,{className:"h-4 w-4"})})});m.displayName=r.$G.displayName;let x=l.forwardRef((e,a)=>{let{className:s,children:l,position:i="popper",...n}=e;return(0,t.jsx)(r.h_,{children:(0,t.jsxs)(r.VY,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:i,...n,children:[(0,t.jsx)(p,{}),(0,t.jsx)(r.l_,{className:(0,c.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(m,{})]})})});x.displayName=r.VY.displayName,l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.__,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})}).displayName=r.__.displayName;let v=l.forwardRef((e,a)=>{let{className:s,children:l,...i}=e;return(0,t.jsxs)(r.ck,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.wU,{children:(0,t.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(r.eT,{children:l})]})});v.displayName=r.ck.displayName,l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)(r.Z0,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...l})}).displayName=r.Z0.displayName},23444:function(e,a,s){"use strict";s.d(a,{g:function(){return i}});var t=s(3827),l=s(64090),r=s(1657);let i=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...l})});i.displayName="Textarea"},53879:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},49108:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},19175:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},59886:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},42527:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},85904:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},70094:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},70699:function(e,a,s){"use strict";s.d(a,{Z:function(){return t}});/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,s(57977).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},24602:function(e,a,s){"use strict";s.d(a,{f:function(){return n}});var t=s(64090),l=s(29586),r=s(3827),i=t.forwardRef((e,a)=>(0,r.jsx)(l.WV.label,{...e,ref:a,onMouseDown:a=>{var s;a.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));i.displayName="Label";var n=i}},function(e){e.O(0,[6860,9593,8792,162,703,9096,1686,9682,4011,6863,2971,8069,1744],function(){return e(e.s=4336)}),_N_E=e.O()}]);