(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{20067:function(){},72061:function(){},48462:function(e,l,a){Promise.resolve().then(a.bind(a,12611))},12611:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return J}});var s=a(3827),r=a(26863),n=a(64090),t=a(19160),i=a(45179),d=a(85754),o=a(45509),c=a(31478),u=a(27815),h=a(85904),p=a(42527),x=a(70094),v=a(10632),m=a(28670),j=a(37211),f=a(28814),y=a(58390),g=a(70769),b=a(47788),N=a(42706),w=a(47907),S=a(1657),C=a(14323),T=a(29644);let k=e=>new Promise((l,a)=>{let s=new FileReader;s.onload=e=>{try{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result,r=C.ij(a,{type:"binary"}),n=r.SheetNames[0],t=r.Sheets[n],i=C.P6.sheet_to_json(t).map(e=>({_id:(0,T.Z)(),name:e.name||"",email:e.email||"",phone:e.phone||"",status:e.status||"new",property:e.property||"",date:new Date().toISOString(),notes:e.notes||"",callHistory:[],strategy:{lastUpdated:new Date().toISOString(),tasks:[],notes:""}}));l(i)}catch(e){a(e)}},s.onerror=e=>a(e),s.readAsBinaryString(e)});var P=a(38152);let _=P.zt,L=P.fC,R=P.xz,Q=n.forwardRef((e,l)=>{let{className:a,sideOffset:r=4,...n}=e;return(0,s.jsx)(P.VY,{ref:l,sideOffset:r,className:(0,S.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})});Q.displayName=P.VY.displayName;var V=a(49842),A=a(40110),E=a(23444);let B=[{value:"cold",label:"Cold"},{value:"warm",label:"Warm"},{value:"hot",label:"Hot"},{value:"mild",label:"Mild"}],z=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"not answering",label:"Not Answering"},{value:"not actively answering",label:"Not Actively Answering"},{value:"always responding",label:"Always Responding"}],I=[{value:"website",label:"Website Enquiry"},{value:"google ads",label:"Google Ads"},{value:"meta",label:"Meta"},{value:"refferal",label:"Referral"},{value:"linkedin",label:"LinkedIn"},{value:"youtube",label:"YouTube"}],F=[{value:"Pre construction",label:"Pre Construction"},{value:"resale",label:"Resale"},{value:"seller",label:"Seller"},{value:"buyer",label:"Buyer"}],O=[{value:"Investor",label:"Investor"},{value:"custom buyer",label:"Custom Buyer"},{value:"first home buyer",label:"First Home Buyer"},{value:"seasonal investor",label:"Seasonal Investor"},{value:"commercial buyer",label:"Commercial Buyer"}],U=[{value:"downtown",label:"Downtown"},{value:"north_york",label:"North York"},{value:"scarborough",label:"Scarborough"},{value:"etobicoke",label:"Etobicoke"},{value:"mississauga",label:"Mississauga"},{value:"brampton",label:"Brampton"},{value:"markham",label:"Markham"},{value:"vaughan",label:"Vaughan"}];function Z(){var e,l,a,r,C,T,P,Z,D,H,M,q,J,Y;let[$,K]=(0,n.useState)([]),[W,G]=(0,n.useState)(!1),[X,ee]=(0,n.useState)("All"),[el,ea]=(0,n.useState)(""),[es,er]=(0,n.useState)(!0),{toast:en}=(0,b.pm)(),[et,ei]=(0,n.useState)(null),[ed,eo]=(0,n.useState)(!1),ec=(0,w.useRouter)(),[eu,eh]=(0,n.useState)(!1),[ep,ex]=(0,n.useState)([]),[ev,em]=(0,n.useState)(!1),[ej,ef]=(0,n.useState)(!1),[ey,eg]=(0,n.useState)({leadStatus:"",leadType:"",leadSource:"",leadResponse:"",clientType:"",assignedTo:"",location:""}),[eb,eN]=(0,n.useState)(""),[ew,eS]=(0,n.useState)(!1),[eC,eT]=(0,n.useState)(!1),[ek,eP]=(0,n.useState)("all"),[e_,eL]=(0,n.useState)("all"),[eR,eQ]=(0,n.useState)({name:"",email:"",phone:"",property:"",leadStatus:"",leadType:"",leadSource:"",leadResponse:"",clientType:"",location:"",assignedTo:"",notes:"",propertyPreferences:{budget:{min:0,max:0},propertyType:""}}),[eV,eA]=(0,n.useState)(!1),[eE,eB]=(0,n.useState)(!1);(0,n.useEffect)(()=>{G(!0),ez(),eI()},[]),(0,n.useEffect)(()=>{if(W){ez();let e=()=>{K(JSON.parse(localStorage.getItem("leads")||"[]"))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}},[W]);let ez=async()=>{try{er(!0);let e=await fetch("/api/leads");if(!e.ok)throw Error("Failed to fetch leads");let l=await e.json();K(l),localStorage.setItem("leads",JSON.stringify(l))}catch(e){console.error("Fetch leads error:",e),en({variant:"destructive",title:"Error",description:"Failed to fetch leads. Please try again."}),K(JSON.parse(localStorage.getItem("leads")||"[]"))}finally{er(!1)}},eI=async()=>{try{let e=await fetch("/api/users"),l=await e.json();ex(l)}catch(e){console.error("Error fetching users:",e),en({variant:"destructive",title:"Error",description:"Failed to fetch users"})}},eF=e=>{let l=ep.find(l=>l._id===e);return l?l.name:"Unassigned"},eO=async(e,l)=>{try{let a=await fetch("/api/call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:e,phoneNumber:l})}),s=await a.json();if(!a.ok)throw Error(s.error||"Failed to initiate call");en({title:"Call Initiated",description:"Connecting your call..."}),ez()}catch(e){console.error("Call error:",e),en({variant:"destructive",title:"Error",description:e instanceof Error?e.message:"Failed to initiate call. Please try again."})}},eU=async e=>{var l;let a=null===(l=e.target.files)||void 0===l?void 0:l[0];if(a)try{let e=await k(a);if(!(await fetch("/api/leads/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leads:e})})).ok)throw Error("Failed to save leads to database");let l=[...JSON.parse(localStorage.getItem("leads")||"[]"),...e];localStorage.setItem("leads",JSON.stringify(l)),ez(),en({title:"Success",description:"".concat(e.length," leads imported successfully")})}catch(e){console.error("Import error:",e),en({variant:"destructive",title:"Import Failed",description:"Failed to import leads. Please check the file format and try again."})}finally{e.target.value=""}},eZ=e=>{let l={cold:"bg-blue-100 text-blue-800",warm:"bg-yellow-100 text-yellow-800",hot:"bg-red-100 text-red-800",mild:"bg-green-100 text-green-800"};return l[e]||l.cold},eD=e=>({"Pre construction":"bg-purple-100 text-purple-800",resale:"bg-indigo-100 text-indigo-800",seller:"bg-pink-100 text-pink-800",buyer:"bg-orange-100 text-orange-800"})[e]||"bg-gray-100 text-gray-800",eH=e=>({website:"bg-green-100 text-green-800","google ads":"bg-blue-100 text-blue-800",meta:"bg-purple-100 text-purple-800",refferal:"bg-yellow-100 text-yellow-800",linkedin:"bg-sky-100 text-sky-800",youtube:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800",eM=()=>{let e=[...$];if(eb){let l=eb.toLowerCase();e=e.filter(e=>{var a,s,r,n,t,i,d,o,c,u,h,p,x,v,m,j,f,y,g,b,N,w,S,C,T,k;let P=(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(l))||(null===(r=e.phone)||void 0===r?void 0:r.includes(l))||(null===(n=e.property)||void 0===n?void 0:n.toLowerCase().includes(l)),_=null===(t=B.find(l=>l.value===e.leadStatus))||void 0===t?void 0:t.label.toLowerCase().includes(l),L=null===(i=F.find(l=>l.value===e.leadType))||void 0===i?void 0:i.label.toLowerCase().includes(l),R=null===(d=I.find(l=>l.value===e.leadSource))||void 0===d?void 0:d.label.toLowerCase().includes(l),Q=null===(o=z.find(l=>l.value===e.leadResponse))||void 0===o?void 0:o.label.toLowerCase().includes(l),V=null===(c=O.find(l=>l.value===e.clientType))||void 0===c?void 0:c.label.toLowerCase().includes(l),A=null===(u=U.find(l=>l.value===e.location))||void 0===u?void 0:u.label.toLowerCase().includes(l),E=null===(h=ep.find(l=>l._id===e.assignedTo))||void 0===h?void 0:h.name.toLowerCase().includes(l),Z=null===(p=e.notes)||void 0===p?void 0:p.toLowerCase().includes(l),D=(null===(v=e.propertyPreferences)||void 0===v?void 0:null===(x=v.propertyType)||void 0===x?void 0:x.some(e=>e.toLowerCase().includes(l)))||(null===(j=e.propertyPreferences)||void 0===j?void 0:null===(m=j.locations)||void 0===m?void 0:m.some(e=>e.toLowerCase().includes(l)))||(null===(y=e.propertyPreferences)||void 0===y?void 0:null===(f=y.features)||void 0===f?void 0:f.some(e=>e.toLowerCase().includes(l))),H=null===(g=e.callHistory)||void 0===g?void 0:g.some(e=>{var a;return null===(a=e.points)||void 0===a?void 0:a.some(e=>e.text.toLowerCase().includes(l))});return[e.name,e.email,e.phone,e.property,null===(b=B.find(l=>l.value===e.leadStatus))||void 0===b?void 0:b.label,null===(N=F.find(l=>l.value===e.leadType))||void 0===N?void 0:N.label,null===(w=I.find(l=>l.value===e.leadSource))||void 0===w?void 0:w.label,null===(S=z.find(l=>l.value===e.leadResponse))||void 0===S?void 0:S.label,null===(C=O.find(l=>l.value===e.clientType))||void 0===C?void 0:C.label,null===(T=U.find(l=>l.value===e.location))||void 0===T?void 0:T.label,null===(k=ep.find(l=>l._id===e.assignedTo))||void 0===k?void 0:k.name,e.notes].filter(Boolean).join(" ").toLowerCase().includes(l)||P||_||L||R||Q||V||A||E||Z||D||H})}return"All"!==X&&(e=e.filter(e=>e.leadStatus===X)),ew&&(e=e.filter(e=>!e.callHistory||0===e.callHistory.length)),eC&&(e=e.filter(e=>"website"===e.leadSource)),ey.leadStatus&&(e=e.filter(e=>e.leadStatus===ey.leadStatus)),ey.leadType&&(e=e.filter(e=>e.leadType===ey.leadType)),ey.leadSource&&(e=e.filter(e=>e.leadSource===ey.leadSource)),ey.leadResponse&&(e=e.filter(e=>e.leadResponse===ey.leadResponse)),ey.clientType&&(e=e.filter(e=>e.clientType===ey.clientType)),ey.assignedTo&&(e=e.filter(e=>e.assignedTo===ey.assignedTo)),ey.location&&(e=e.filter(e=>e.location===ey.location)),e},eq=e=>{let l=eM();return e&&"all"!==e?l.filter(l=>l.leadStatus===e):l},eJ=e=>{let l=eM();return e&&"all"!==e?l.filter(l=>{var a,s,r;return(null===(a=l.location)||void 0===a?void 0:a.toLowerCase())===e.toLowerCase()||(null===(r=l.propertyPreferences)||void 0===r?void 0:null===(s=r.locations)||void 0===s?void 0:s.some(l=>l.toLowerCase()===e.toLowerCase()))}):l},eY=()=>{eQ({name:"",email:"",phone:"",property:"",leadStatus:"",leadType:"",leadSource:"",leadResponse:"",clientType:"",location:"",assignedTo:"",notes:"",propertyPreferences:{budget:{min:0,max:0},propertyType:""}})},e$=async()=>{try{if(!eR.name||!eR.email||!eR.phone){en({variant:"destructive",title:"Error",description:"Please fill in all required fields (Name, Email, Phone)"});return}if(!(await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...eR,date:new Date().toISOString()})})).ok)throw Error("Failed to add lead");ez(),eY(),em(!1),en({title:"Success",description:"Lead added successfully"})}catch(e){console.error("Add lead error:",e),en({variant:"destructive",title:"Error",description:"Failed to add lead. Please try again."})}};return W?(0,s.jsxs)(u.Zb,{children:[(0,s.jsxs)(u.Ol,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(u.ll,{children:"Lead Management"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(d.z,{variant:ew?"default":"outline",onClick:()=>eS(!ew),className:"bg-red-50 hover:bg-red-100 text-red-600 hover:text-red-700 border-red-200",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"No Calls (",$.filter(e=>!e.callHistory||0===e.callHistory.length).length,")"]}),(0,s.jsxs)(d.z,{variant:eC?"default":"outline",className:"bg-blue-50 hover:bg-blue-100 text-blue-600 hover:text-blue-700 border-blue-200",onClick:()=>eT(!eC),children:[(0,s.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Website Enquiries (",$.filter(e=>"website"===e.leadSource).length,")"]}),(0,s.jsxs)(d.z,{onClick:()=>em(!0),className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Add Lead"]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.I,{type:"file",id:"excel-upload",className:"hidden",accept:".xlsx,.xls",onChange:eU}),(0,s.jsxs)(d.z,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("excel-upload"))||void 0===e?void 0:e.click()},className:"border-green-600 text-green-600 hover:bg-green-50",children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Import Leads"]})]})]})]}),(0,s.jsx)("div",{className:"mt-4 border-b",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(d.z,{variant:"all"===ek?"default":"ghost",onClick:()=>eP("all"),className:"relative rounded-none border-b-2 border-transparent px-4",children:["All Leads (",eM().length,")"]}),(0,s.jsxs)(d.z,{variant:"hot"===ek?"default":"ghost",onClick:()=>eP("hot"),className:"relative rounded-none border-b-2 border-transparent px-4 text-red-600 hover:text-red-700",children:["Hot Leads (",eq("hot").length,")"]}),(0,s.jsxs)(d.z,{variant:"warm"===ek?"default":"ghost",onClick:()=>eP("warm"),className:"relative rounded-none border-b-2 border-transparent px-4 text-yellow-600 hover:text-yellow-700",children:["Warm Leads (",eq("warm").length,")"]}),(0,s.jsxs)(d.z,{variant:"cold"===ek?"default":"ghost",onClick:()=>eP("cold"),className:"relative rounded-none border-b-2 border-transparent px-4 text-blue-600 hover:text-blue-700",children:["Cold Leads (",eq("cold").length,")"]}),(0,s.jsxs)(d.z,{variant:"mild"===ek?"default":"ghost",onClick:()=>eP("mild"),className:"relative rounded-none border-b-2 border-transparent px-4 text-green-600 hover:text-green-700",children:["Mild Leads (",eq("mild").length,")"]})]})}),(0,s.jsx)("div",{className:"mt-4 border-b",children:(0,s.jsxs)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[(0,s.jsxs)(d.z,{variant:"all"===e_?"default":"ghost",onClick:()=>eL("all"),className:"relative rounded-none border-b-2 border-transparent px-4 whitespace-nowrap",children:["All Locations (",eM().length,")"]}),U.map(e=>(0,s.jsxs)(d.z,{variant:e_===e.value?"default":"ghost",onClick:()=>eL(e.value),className:"relative rounded-none border-b-2 border-transparent px-4 whitespace-nowrap",children:[e.label," (",eJ(e.value).length,")"]},e.value))]})}),(0,s.jsx)("div",{className:"flex gap-2 mt-4",children:(0,s.jsxs)("div",{className:"flex-1 flex gap-2",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(m.Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(i.I,{placeholder:"Search leads by any field (name, email, phone, status, location, etc.)",value:eb,onChange:e=>eN(e.target.value),className:"pl-8"})]}),(0,s.jsxs)(N.Vq,{open:ej,onOpenChange:ef,children:[(0,s.jsx)(N.hg,{asChild:!0,children:(0,s.jsxs)(d.z,{variant:"outline",className:Object.values(ey).some(e=>""!==e)?"bg-blue-50 text-blue-600 border-blue-200":"",children:[(0,s.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Filters ",Object.values(ey).filter(e=>""!==e).length>0&&"(".concat(Object.values(ey).filter(e=>""!==e).length,")")]})}),(0,s.jsxs)(N.cZ,{className:"max-w-3xl",children:[(0,s.jsx)(N.fK,{children:(0,s.jsx)(N.$N,{children:"Filter Leads"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Status"}),(0,s.jsxs)(o.Ph,{value:ey.leadStatus,onValueChange:e=>eg({...ey,leadStatus:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select status"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),B.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Type"}),(0,s.jsxs)(o.Ph,{value:ey.leadType,onValueChange:e=>eg({...ey,leadType:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select type"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),F.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Source"}),(0,s.jsxs)(o.Ph,{value:ey.leadSource,onValueChange:e=>eg({...ey,leadSource:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select source"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),I.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Response"}),(0,s.jsxs)(o.Ph,{value:ey.leadResponse,onValueChange:e=>eg({...ey,leadResponse:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select response"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),z.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Client Type"}),(0,s.jsxs)(o.Ph,{value:ey.clientType,onValueChange:e=>eg({...ey,clientType:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select client type"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),O.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Location"}),(0,s.jsxs)(o.Ph,{value:ey.location,onValueChange:e=>eg({...ey,location:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select location"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All Locations"}),U.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Assigned To"}),(0,s.jsxs)(o.Ph,{value:ey.assignedTo,onValueChange:e=>eg({...ey,assignedTo:"all"===e?"":e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select user"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"all",children:"All"}),(0,s.jsx)(o.Ql,{value:"unassigned",children:"Unassigned"}),ep.map(e=>(0,s.jsx)(o.Ql,{value:e._id,children:e.name},e._id))]})]})]}),(0,s.jsxs)("div",{className:"col-span-2 flex justify-end gap-2 mt-4",children:[(0,s.jsx)(d.z,{variant:"outline",onClick:()=>{eg({leadStatus:"",leadType:"",leadSource:"",leadResponse:"",clientType:"",assignedTo:"",location:""})},className:"border-red-200 text-red-600 hover:bg-red-50",children:"Reset Filters"}),(0,s.jsx)(d.z,{onClick:()=>ef(!1),className:"bg-blue-600 text-white hover:bg-blue-700",children:"Apply Filters"})]})]})]})]})]})})]}),(0,s.jsx)(u.aY,{children:(0,s.jsxs)(t.iA,{children:[(0,s.jsx)(t.xD,{children:(0,s.jsxs)(t.SC,{children:[(0,s.jsx)(t.ss,{children:"Name"}),(0,s.jsx)(t.ss,{children:"Contact"}),(0,s.jsx)(t.ss,{children:"Status"}),(0,s.jsx)(t.ss,{children:"Type"}),(0,s.jsx)(t.ss,{children:"Source"}),(0,s.jsx)(t.ss,{children:"Location"}),(0,s.jsx)(t.ss,{children:"Property"}),(0,s.jsx)(t.ss,{children:"Created"}),(0,s.jsx)(t.ss,{children:"Assigned To"}),(0,s.jsx)(t.ss,{children:"Actions"})]})}),(0,s.jsx)(t.RM,{children:eJ(e_).filter(e=>"all"===ek||e.leadStatus===ek).map(e=>{var l,a,r;return(0,s.jsxs)(t.SC,{children:[(0,s.jsx)(t.pj,{children:(0,s.jsx)(d.z,{variant:"link",className:"p-0 h-auto font-normal text-black hover:text-gray-700",onClick:()=>ec.push("/lead/".concat(e._id)),children:e.name})}),(0,s.jsx)(t.pj,{children:(0,s.jsxs)("div",{className:"text-sm text-black",children:[(0,s.jsx)("div",{children:e.email}),(0,s.jsx)("div",{className:"text-gray-600",children:e.phone})]})}),(0,s.jsx)(t.pj,{children:(0,s.jsx)(c.C,{className:eZ(e.leadStatus||"cold"),children:(e.leadStatus||"cold").charAt(0).toUpperCase()+(e.leadStatus||"cold").slice(1)})}),(0,s.jsx)(t.pj,{children:(0,s.jsx)(c.C,{className:eD(e.leadType),children:(e.leadType||"buyer").charAt(0).toUpperCase()+(e.leadType||"buyer").slice(1)})}),(0,s.jsx)(t.pj,{children:(0,s.jsx)(c.C,{className:eH(e.leadSource),children:(null===(l=e.leadSource)||void 0===l?void 0:l.charAt(0).toUpperCase())+(null===(a=e.leadSource)||void 0===a?void 0:a.slice(1))||"Unknown"})}),(0,s.jsx)(t.pj,{children:(0,s.jsx)(c.C,{variant:"outline",children:e.location||"Not specified"})}),(0,s.jsx)(t.pj,{children:e.property}),(0,s.jsx)(t.pj,{children:(0,S.p)(e.date)}),(0,s.jsx)(t.pj,{children:e.assignedTo?eF(e.assignedTo):"Unassigned"}),(0,s.jsx)(t.pj,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(d.z,{variant:"outline",size:"sm",className:"flex-1 border-black text-black hover:bg-black hover:text-white",onClick:()=>eO(e._id,e.phone),children:[(0,s.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Call"]}),(0,s.jsx)(_,{children:(0,s.jsxs)(L,{children:[(0,s.jsx)(R,{asChild:!0,children:(0,s.jsx)(d.z,{variant:"outline",size:"sm",className:"border-black text-black hover:bg-black hover:text-white",onClick:l=>{l.preventDefault(),l.stopPropagation(),ei(e),eA(!0)},children:(0,s.jsx)(f.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(Q,{children:(0,s.jsx)("p",{children:"View full details"})})]})})]}),(0,s.jsxs)(d.z,{variant:"outline",size:"sm",className:"border-black text-black hover:bg-black hover:text-white w-full",onClick:()=>eh(!0),children:[(0,s.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"View Call History"]}),(0,s.jsx)("div",{className:"mt-2 space-y-1",children:(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["Tasks: ",(null===(r=e.tasks)||void 0===r?void 0:r.length)||0,e.tasks&&e.tasks.length>0&&(0,s.jsxs)("span",{className:"ml-2 text-gray-500",children:["(",e.tasks.filter(e=>"pending"===e.status).length," pending)"]})]})})]})})]},e._id)})})]})}),(0,s.jsx)(N.Vq,{open:ev,onOpenChange:e=>{em(e),e||eY()},children:(0,s.jsxs)(N.cZ,{className:"max-w-3xl",children:[(0,s.jsx)(N.fK,{children:(0,s.jsx)(N.$N,{children:"Add New Lead"})}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 py-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Name *"}),(0,s.jsx)(i.I,{placeholder:"Enter lead name",value:eR.name,onChange:e=>eQ({...eR,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Email *"}),(0,s.jsx)(i.I,{type:"email",placeholder:"Enter email address",value:eR.email,onChange:e=>eQ({...eR,email:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Phone *"}),(0,s.jsx)(i.I,{placeholder:"Enter phone number",value:eR.phone,onChange:e=>eQ({...eR,phone:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Property"}),(0,s.jsx)(i.I,{placeholder:"Enter property details",value:eR.property,onChange:e=>eQ({...eR,property:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Status"}),(0,s.jsxs)(o.Ph,{value:eR.leadStatus,onValueChange:e=>eQ({...eR,leadStatus:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select status"})}),(0,s.jsx)(o.Bw,{children:B.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Type"}),(0,s.jsxs)(o.Ph,{value:eR.leadType,onValueChange:e=>eQ({...eR,leadType:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select type"})}),(0,s.jsx)(o.Bw,{children:F.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Source"}),(0,s.jsxs)(o.Ph,{value:eR.leadSource,onValueChange:e=>eQ({...eR,leadSource:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select source"})}),(0,s.jsx)(o.Bw,{children:I.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Response"}),(0,s.jsxs)(o.Ph,{value:eR.leadResponse,onValueChange:e=>eQ({...eR,leadResponse:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select response"})}),(0,s.jsx)(o.Bw,{children:z.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Client Type"}),(0,s.jsxs)(o.Ph,{value:eR.clientType,onValueChange:e=>eQ({...eR,clientType:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select client type"})}),(0,s.jsx)(o.Bw,{children:O.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Location"}),(0,s.jsxs)(o.Ph,{value:eR.location,onValueChange:e=>eQ({...eR,location:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select location"})}),(0,s.jsx)(o.Bw,{children:U.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Assigned To"}),(0,s.jsxs)(o.Ph,{value:eR.assignedTo,onValueChange:e=>eQ({...eR,assignedTo:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select user"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"unassigned",children:"Unassigned"}),ep.map(e=>(0,s.jsx)(o.Ql,{value:e._id,children:e.name},e._id))]})]})]}),(0,s.jsxs)("div",{className:"col-span-2 space-y-2",children:[(0,s.jsx)(V._,{children:"Property Preferences"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Budget Range"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.I,{type:"number",placeholder:"Min",value:eR.propertyPreferences.budget.min,onChange:e=>eQ({...eR,propertyPreferences:{...eR.propertyPreferences,budget:{...eR.propertyPreferences.budget,min:parseInt(e.target.value)||0}}})}),(0,s.jsx)(i.I,{type:"number",placeholder:"Max",value:eR.propertyPreferences.budget.max,onChange:e=>eQ({...eR,propertyPreferences:{...eR.propertyPreferences,budget:{...eR.propertyPreferences.budget,max:parseInt(e.target.value)||0}}})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Property Type"}),(0,s.jsxs)(o.Ph,{value:eR.propertyPreferences.propertyType,onValueChange:e=>eQ({...eR,propertyPreferences:{...eR.propertyPreferences,propertyType:e}}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select property type"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"detached",children:"Detached"}),(0,s.jsx)(o.Ql,{value:"semi-detached",children:"Semi-Detached"}),(0,s.jsx)(o.Ql,{value:"townhouse",children:"Townhouse"}),(0,s.jsx)(o.Ql,{value:"condo",children:"Condo"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"col-span-2 space-y-2",children:[(0,s.jsx)(V._,{children:"Notes"}),(0,s.jsx)(E.g,{placeholder:"Enter any additional notes about the lead",className:"min-h-[100px]",value:eR.notes,onChange:e=>eQ({...eR,notes:e.target.value})})]}),(0,s.jsxs)("div",{className:"col-span-2 flex justify-end gap-2 mt-4",children:[(0,s.jsx)(d.z,{variant:"outline",onClick:()=>{em(!1),eY()},className:"border-red-200 text-red-600 hover:bg-red-50",children:"Cancel"}),(0,s.jsx)(d.z,{onClick:e$,className:"bg-green-600 text-white hover:bg-green-700",children:"Add Lead"})]})]})]})}),(0,s.jsx)(N.Vq,{open:eV,onOpenChange:e=>{eA(e),e||(ei(null),eB(!1))},children:(0,s.jsxs)(N.cZ,{className:"max-w-4xl",children:[(0,s.jsx)(N.fK,{children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(N.$N,{children:"Lead Details"}),eE?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.z,{variant:"outline",onClick:()=>eB(!1),className:"border-red-200 text-red-600 hover:bg-red-50",children:"Cancel"}),(0,s.jsx)(d.z,{onClick:async()=>{if(et)try{if(!(await fetch("/api/leads/".concat(et._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(et)})).ok)throw Error("Failed to update lead");en({title:"Success",description:"Lead updated successfully"}),eB(!1),ez()}catch(e){console.error("Update lead error:",e),en({variant:"destructive",title:"Error",description:"Failed to update lead. Please try again."})}},className:"bg-green-600 text-white hover:bg-green-700",children:"Save Changes"})]}):(0,s.jsxs)(d.z,{variant:"outline",onClick:()=>eB(!0),className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Edit Lead"]})]})}),et&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(A.mQ,{defaultValue:"details",className:"w-full",children:[(0,s.jsxs)(A.dr,{className:"w-full justify-start",children:[(0,s.jsx)(A.SP,{value:"details",children:"Details"}),(0,s.jsx)(A.SP,{value:"preferences",children:"Property Preferences"}),(0,s.jsx)(A.SP,{value:"history",children:"Call History"}),(0,s.jsx)(A.SP,{value:"tasks",children:"Tasks"}),(0,s.jsx)(A.SP,{value:"notes",children:"Notes"})]}),(0,s.jsx)(A.nU,{value:"details",className:"mt-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Name"}),eE?(0,s.jsx)(i.I,{value:et.name,onChange:e=>ei({...et,name:e.target.value})}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Email"}),eE?(0,s.jsx)(i.I,{type:"email",value:et.email,onChange:e=>ei({...et,email:e.target.value})}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.email})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Phone"}),eE?(0,s.jsx)(i.I,{value:et.phone,onChange:e=>ei({...et,phone:e.target.value})}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.phone})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Property"}),eE?(0,s.jsx)(i.I,{value:et.property,onChange:e=>ei({...et,property:e.target.value})}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.property||"Not specified"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Status"}),eE?(0,s.jsxs)(o.Ph,{value:et.leadStatus,onValueChange:e=>ei({...et,leadStatus:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:B.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)(c.C,{className:eZ(et.leadStatus||"cold"),children:(et.leadStatus||"cold").charAt(0).toUpperCase()+(et.leadStatus||"cold").slice(1)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Type"}),eE?(0,s.jsxs)(o.Ph,{value:et.leadType,onValueChange:e=>ei({...et,leadType:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:F.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)(c.C,{className:eD(et.leadType),children:(et.leadType||"buyer").charAt(0).toUpperCase()+(et.leadType||"buyer").slice(1)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Source"}),eE?(0,s.jsxs)(o.Ph,{value:et.leadSource,onValueChange:e=>ei({...et,leadSource:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:I.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)(c.C,{className:eH(et.leadSource),children:(null===(e=et.leadSource)||void 0===e?void 0:e.charAt(0).toUpperCase())+(null===(l=et.leadSource)||void 0===l?void 0:l.slice(1))||"Unknown"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Lead Response"}),eE?(0,s.jsxs)(o.Ph,{value:et.leadResponse,onValueChange:e=>ei({...et,leadResponse:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:z.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.leadResponse||"Not specified"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Client Type"}),eE?(0,s.jsxs)(o.Ph,{value:et.clientType,onValueChange:e=>ei({...et,clientType:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:O.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.clientType||"Not specified"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Location"}),eE?(0,s.jsxs)(o.Ph,{value:et.location,onValueChange:e=>ei({...et,location:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsx)(o.Bw,{children:U.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]}):(0,s.jsx)(c.C,{variant:"outline",children:et.location||"Not specified"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Assigned To"}),eE?(0,s.jsxs)(o.Ph,{value:et.assignedTo,onValueChange:e=>ei({...et,assignedTo:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"unassigned",children:"Unassigned"}),ep.map(e=>(0,s.jsx)(o.Ql,{value:e._id,children:e.name},e._id))]})]}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:et.assignedTo?eF(et.assignedTo):"Unassigned"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Created"}),(0,s.jsx)("div",{className:"p-2 border rounded-md",children:(0,S.p)(et.date)})]})]})}),(0,s.jsx)(A.nU,{value:"preferences",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Budget Range"}),eE?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.I,{type:"number",placeholder:"Min",value:null===(r=et.propertyPreferences)||void 0===r?void 0:null===(a=r.budget)||void 0===a?void 0:a.min,onChange:e=>{var l,a,s,r,n,t,i,d,o;return ei({...et,propertyPreferences:{...et.propertyPreferences,budget:{min:Number(null===(a=et.propertyPreferences)||void 0===a?void 0:null===(l=a.budget)||void 0===l?void 0:l.min)||0,max:Number(null===(r=et.propertyPreferences)||void 0===r?void 0:null===(s=r.budget)||void 0===s?void 0:s.max)||0},propertyType:(null===(n=et.propertyPreferences)||void 0===n?void 0:n.propertyType)||[],bedrooms:(null===(t=et.propertyPreferences)||void 0===t?void 0:t.bedrooms)||0,bathrooms:(null===(i=et.propertyPreferences)||void 0===i?void 0:i.bathrooms)||0,locations:(null===(d=et.propertyPreferences)||void 0===d?void 0:d.locations)||[],features:(null===(o=et.propertyPreferences)||void 0===o?void 0:o.features)||[]}})}}),(0,s.jsx)(i.I,{type:"number",placeholder:"Max",value:null===(T=et.propertyPreferences)||void 0===T?void 0:null===(C=T.budget)||void 0===C?void 0:C.max,onChange:e=>{var l,a,s,r,n,t,i;return ei({...et,propertyPreferences:{...et.propertyPreferences,budget:{min:(null===(a=et.propertyPreferences)||void 0===a?void 0:null===(l=a.budget)||void 0===l?void 0:l.min)||0,max:parseInt(e.target.value)||0},propertyType:(null===(s=et.propertyPreferences)||void 0===s?void 0:s.propertyType)||[],bedrooms:(null===(r=et.propertyPreferences)||void 0===r?void 0:r.bedrooms)||0,bathrooms:(null===(n=et.propertyPreferences)||void 0===n?void 0:n.bathrooms)||0,locations:(null===(t=et.propertyPreferences)||void 0===t?void 0:t.locations)||[],features:(null===(i=et.propertyPreferences)||void 0===i?void 0:i.features)||[]}})}})]}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:(null===(Z=et.propertyPreferences)||void 0===Z?void 0:null===(P=Z.budget)||void 0===P?void 0:P.min)&&(null===(H=et.propertyPreferences)||void 0===H?void 0:null===(D=H.budget)||void 0===D?void 0:D.max)?"$".concat(et.propertyPreferences.budget.min," - $").concat(et.propertyPreferences.budget.max):"Not specified"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Property Type"}),eE?(0,s.jsxs)(o.Ph,{value:null!==(Y=null===(q=et.propertyPreferences)||void 0===q?void 0:null===(M=q.propertyType)||void 0===M?void 0:M[0])&&void 0!==Y?Y:"",onValueChange:e=>{var l,a,s,r,n;return ei({...et,propertyPreferences:{budget:(null===(l=et.propertyPreferences)||void 0===l?void 0:l.budget)||{min:0,max:0},propertyType:[e],bedrooms:(null===(a=et.propertyPreferences)||void 0===a?void 0:a.bedrooms)||0,bathrooms:(null===(s=et.propertyPreferences)||void 0===s?void 0:s.bathrooms)||0,locations:(null===(r=et.propertyPreferences)||void 0===r?void 0:r.locations)||[],features:(null===(n=et.propertyPreferences)||void 0===n?void 0:n.features)||[]}})},children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"detached",children:"Detached"}),(0,s.jsx)(o.Ql,{value:"semi-detached",children:"Semi-Detached"}),(0,s.jsx)(o.Ql,{value:"townhouse",children:"Townhouse"}),(0,s.jsx)(o.Ql,{value:"condo",children:"Condo"})]})]}):(0,s.jsx)("div",{className:"p-2 border rounded-md",children:(null===(J=et.propertyPreferences)||void 0===J?void 0:J.propertyType)||"Not specified"})]})]})})}),(0,s.jsx)(A.nU,{value:"history",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:et.callHistory&&et.callHistory.length>0?et.callHistory.map((e,l)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-2",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:(0,S.p)(e.date)}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:[e.duration," minutes"]})]})}),e.points&&e.points.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("div",{className:"font-medium mb-1",children:"Key Points:"}),(0,s.jsx)("ul",{className:"list-disc pl-4 space-y-1",children:e.points.map((e,l)=>(0,s.jsx)("li",{children:e.text},l))})]})]},l)):(0,s.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No call history available"})})}),(0,s.jsx)(A.nU,{value:"tasks",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:et.tasks&&et.tasks.length>0?et.tasks.map((e,l)=>(0,s.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.title}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]}),(0,s.jsx)(c.C,{variant:"completed"===e.status?"default":"outline",children:e.status})]}),(0,s.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Due: ",(0,S.p)(e.date)]})]},l)):(0,s.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No tasks available"})})}),(0,s.jsx)(A.nU,{value:"notes",className:"mt-4",children:(0,s.jsx)("div",{className:"space-y-4",children:eE?(0,s.jsx)(E.g,{placeholder:"Enter notes about the lead",className:"min-h-[200px]",value:et.notes,onChange:e=>ei({...et,notes:e.target.value})}):(0,s.jsx)("div",{className:"border rounded-lg p-4 min-h-[200px] whitespace-pre-wrap",children:et.notes||"No notes available"})})})]})})]})})]}):(0,s.jsxs)(u.Zb,{children:[(0,s.jsx)(u.Ol,{children:(0,s.jsx)("div",{className:"flex justify-between items-center",children:(0,s.jsx)(u.ll,{children:"Leads"})})}),(0,s.jsx)(u.aY,{children:(0,s.jsxs)(t.iA,{children:[(0,s.jsx)(t.xD,{children:(0,s.jsxs)(t.SC,{children:[(0,s.jsx)(t.ss,{children:"Name"}),(0,s.jsx)(t.ss,{children:"Contact"}),(0,s.jsx)(t.ss,{children:"Status"}),(0,s.jsx)(t.ss,{children:"Type"}),(0,s.jsx)(t.ss,{children:"Property"}),(0,s.jsx)(t.ss,{children:"Created"}),(0,s.jsx)(t.ss,{children:"Assigned To"}),(0,s.jsx)(t.ss,{children:"Actions"})]})}),(0,s.jsx)(t.RM,{})]})})]})}let D=[{value:"cold",label:"Cold"},{value:"warm",label:"Warm"},{value:"hot",label:"Hot"},{value:"mild",label:"Mild"}],H=[{value:"Pre construction",label:"Pre Construction"},{value:"resale",label:"Resale"},{value:"seller",label:"Seller"},{value:"buyer",label:"Buyer"}],M=[{value:"downtown",label:"Downtown"},{value:"north_york",label:"North York"},{value:"scarborough",label:"Scarborough"},{value:"etobicoke",label:"Etobicoke"},{value:"mississauga",label:"Mississauga"},{value:"brampton",label:"Brampton"},{value:"markham",label:"Markham"},{value:"vaughan",label:"Vaughan"}];function q(e){var l,a,r,t,c,u,h,p,x;let{open:v,onClose:m,lead:j}=e,{toast:f}=(0,b.pm)(),[y,g]=(0,n.useState)(!1),[w,S]=(0,n.useState)([]),[C,T]=(0,n.useState)({name:null!==(l=null==j?void 0:j.name)&&void 0!==l?l:"",email:null!==(a=null==j?void 0:j.email)&&void 0!==a?a:"",phone:null!==(r=null==j?void 0:j.phone)&&void 0!==r?r:"",leadStatus:null!==(t=null==j?void 0:j.leadStatus)&&void 0!==t?t:"cold",leadType:null!==(c=null==j?void 0:j.leadType)&&void 0!==c?c:"buyer",property:null!==(u=null==j?void 0:j.property)&&void 0!==u?u:"",notes:null!==(h=null==j?void 0:j.notes)&&void 0!==h?h:"",assignedTo:null!==(p=null==j?void 0:j.assignedTo)&&void 0!==p?p:"unassigned",location:null!==(x=null==j?void 0:j.location)&&void 0!==x?x:""});(0,n.useEffect)(()=>{k()},[]);let k=async()=>{try{let e=await fetch("/api/users"),l=await e.json();S(l)}catch(e){console.error("Error fetching users:",e),f({variant:"destructive",title:"Error",description:"Failed to fetch users"})}},P=async e=>{e.preventDefault(),g(!0);try{let e={name:C.name,email:C.email,phone:C.phone,leadStatus:C.leadStatus,leadType:C.leadType,property:C.property,notes:C.notes,assignedTo:"unassigned"===C.assignedTo?void 0:C.assignedTo,date:new Date().toISOString(),callHistory:[],tasks:[],propertyPreferences:{budget:{min:0,max:0},propertyType:[],bedrooms:0,bathrooms:0,locations:[],features:[]},leadResponse:"inactive",leadSource:"google ads",clientType:"custom buyer",location:C.location},l=await fetch("/api/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok){let e=await l.json();throw Error(e.message||"Failed to create lead")}f({title:"Success",description:"Lead added successfully."}),T({name:"",email:"",phone:"",leadStatus:"cold",leadType:"buyer",property:"",notes:"",assignedTo:"unassigned",location:""}),null==m||m(),window.location.reload()}catch(e){console.error("Error creating lead:",e),f({title:"Error",description:e instanceof Error?e.message:"Failed to add lead. Please try again.",variant:"destructive"})}finally{g(!1)}};return(0,s.jsx)(N.Vq,{open:v,onOpenChange:m,children:(0,s.jsxs)(N.cZ,{children:[(0,s.jsx)(N.fK,{children:(0,s.jsx)(N.$N,{children:j?"Edit Lead":"Add New Lead"})}),(0,s.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"name",children:"Full Name"}),(0,s.jsx)(i.I,{id:"name",required:!0,value:C.name,onChange:e=>T({...C,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"email",children:"Email"}),(0,s.jsx)(i.I,{id:"email",type:"email",required:!0,value:C.email,onChange:e=>T({...C,email:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"phone",children:"Phone"}),(0,s.jsx)(i.I,{id:"phone",required:!0,value:C.phone,onChange:e=>T({...C,phone:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"status",children:"Status"}),(0,s.jsxs)(o.Ph,{value:C.leadStatus,onValueChange:e=>T({...C,leadStatus:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select status"})}),(0,s.jsx)(o.Bw,{children:D.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"type",children:"Lead Type"}),(0,s.jsxs)(o.Ph,{value:C.leadType,onValueChange:e=>T({...C,leadType:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select type"})}),(0,s.jsx)(o.Bw,{children:H.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Assigned To"}),(0,s.jsxs)(o.Ph,{value:C.assignedTo,onValueChange:e=>T({...C,assignedTo:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select a user"})}),(0,s.jsxs)(o.Bw,{children:[(0,s.jsx)(o.Ql,{value:"unassigned",children:"Unassigned"}),w.map(e=>(0,s.jsx)(o.Ql,{value:e._id,children:e.name},e._id))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"property",children:"Property"}),(0,s.jsx)(i.I,{id:"property",required:!0,value:C.property,onChange:e=>T({...C,property:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(E.g,{id:"notes",value:C.notes,onChange:e=>T({...C,notes:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V._,{children:"Location"}),(0,s.jsxs)(o.Ph,{value:C.location||"",onValueChange:e=>T({...C,location:e}),children:[(0,s.jsx)(o.i4,{children:(0,s.jsx)(o.ki,{placeholder:"Select location"})}),(0,s.jsx)(o.Bw,{children:M.map(e=>(0,s.jsx)(o.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(d.z,{type:"button",variant:"outline",onClick:m,children:"Cancel"}),(0,s.jsx)(d.z,{type:"submit",disabled:y,children:y?"Adding...":"Add Lead"})]})]})]})})}function J(){return(0,s.jsx)(r.c,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",children:"Lead Management"}),(0,s.jsx)(Z,{}),(0,s.jsx)(q,{open:!1,onClose:()=>{}})]})})}},31478:function(e,l,a){"use strict";a.d(l,{C:function(){return i}});var s=a(3827),r=a(49769),n=a(1657);let t=(0,r.j)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:l,variant:a,...r}=e;return(0,s.jsx)("div",{className:(0,n.cn)(t({variant:a}),l),...r})}},49842:function(e,l,a){"use strict";a.d(l,{_:function(){return o}});var s=a(3827),r=a(64090),n=a(24602),t=a(49769),i=a(1657);let d=(0,t.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.f,{ref:l,className:(0,i.cn)(d(),a),...r})});o.displayName=n.f.displayName},45509:function(e,l,a){"use strict";a.d(l,{Bw:function(){return v},Ph:function(){return c},Ql:function(){return m},i4:function(){return h},ki:function(){return u}});var s=a(3827),r=a(64090),n=a(2072),t=a(23441),i=a(85159),d=a(80037),o=a(1657);let c=n.fC;n.ZA;let u=n.B4,h=r.forwardRef((e,l)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(n.xz,{ref:l,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...i,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(t.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.xz.displayName;let p=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.u_,{ref:l,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})});p.displayName=n.u_.displayName;let x=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.$G,{ref:l,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(t.Z,{className:"h-4 w-4"})})});x.displayName=n.$G.displayName;let v=r.forwardRef((e,l)=>{let{className:a,children:r,position:t="popper",...i}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsxs)(n.VY,{ref:l,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:t,...i,children:[(0,s.jsx)(p,{}),(0,s.jsx)(n.l_,{className:(0,o.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(x,{})]})})});v.displayName=n.VY.displayName,r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.__,{ref:l,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=n.__.displayName;let m=r.forwardRef((e,l)=>{let{className:a,children:r,...t}=e;return(0,s.jsxs)(n.ck,{ref:l,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...t,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(n.eT,{children:r})]})});m.displayName=n.ck.displayName,r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:l,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.Z0.displayName},19160:function(e,l,a){"use strict";a.d(l,{RM:function(){return d},SC:function(){return o},iA:function(){return t},pj:function(){return u},ss:function(){return c},xD:function(){return i}});var s=a(3827),r=a(64090),n=a(1657);let t=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:l,className:(0,n.cn)("w-full caption-bottom text-sm",a),...r})})});t.displayName="Table";let i=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:l,className:(0,n.cn)("[&_tr]:border-b",a),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:l,className:(0,n.cn)("[&_tr:last-child]:border-0",a),...r})});d.displayName="TableBody",r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:l,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let o=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:l,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});o.displayName="TableRow";let c=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:l,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});c.displayName="TableHead";let u=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:l,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});u.displayName="TableCell",r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:l,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},40110:function(e,l,a){"use strict";a.d(l,{SP:function(){return o},dr:function(){return d},mQ:function(){return i},nU:function(){return c}});var s=a(3827),r=a(64090),n=a(64694),t=a(1657);let i=n.fC,d=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.aV,{ref:l,className:(0,t.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...r})});d.displayName=n.aV.displayName;let o=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.xz,{ref:l,className:(0,t.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...r})});o.displayName=n.xz.displayName;let c=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{ref:l,className:(0,t.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...r})});c.displayName=n.VY.displayName},23444:function(e,l,a){"use strict";a.d(l,{g:function(){return t}});var s=a(3827),r=a(64090),n=a(1657);let t=r.forwardRef((e,l)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:l,...r})});t.displayName="Textarea"}},function(e){e.O(0,[1425,6860,9593,8792,162,703,9096,1686,5648,4011,6863,2971,8069,1744],function(){return e(e.s=48462)}),_N_E=e.O()}]);