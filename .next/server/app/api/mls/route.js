"use strict";(()=>{var e={};e.id=926,e.ids=[926],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},98955:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>P,originalPathname:()=>L,patchFetch:()=>S,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>v});var a={};r.r(a),r.d(a,{GET:()=>c,dynamic:()=>u,fetchCache:()=>d,revalidate:()=>l});var s=r(95419),o=r(69108),i=r(99678),n=r(78070),p=r(83949);let u="force-dynamic",d="force-no-store",l=0;if(!process.env.MLS_ACCESS_TOKEN)throw Error("MLS_ACCESS_TOKEN is not defined in environment variables");if(!process.env.MLS_API_URL)throw Error("MLS_API_URL is not defined in environment variables");async function c(e){try{let{searchParams:t}=new URL(e.url),r=parseInt(t.get("page")||"1"),a=(r-1)*50,s=t.get("search"),o=t.get("sort")||"default",i=[];if(s){let e=s.trim().split(" ").filter(Boolean);if(e.length>0){let t=e.map(e=>{let t=e.replace(/'/g,"''");return`(
            contains(UnparsedAddress, '${t}') or
            contains(City, '${t}') or
            contains(StateOrProvince, '${t}') or
            contains(PostalCode, '${t}') or
            contains(PropertyType, '${t}')
          )`});i.push(`(${t.join(" and ")})`)}}let u=t.get("priceMin"),d=t.get("priceMax");u&&Number(u)>0&&i.push(`ListPrice ge ${u}`),d&&"any"!==d&&1e6>Number(d)&&i.push(`ListPrice le ${d}`);let l=t.get("beds");l&&"any"!==l&&i.push(`BedroomsTotal ge ${l}`);let c=t.get("baths");c&&"any"!==c&&i.push(`BathroomsTotalInteger ge ${c}`);let h=t.get("propertyType");h&&"any"!==h&&i.push(`PropertyType eq '${h}'`);let m=t.get("status");m&&"any"!==m&&i.push(`StandardStatus eq '${m}'`);let g=["$top=50","$skip="+a,"$count=true","$expand=Media,Features"];i.length>0&&g.push("$filter="+i.join(" and "));let y="ModificationTimestamp desc";switch(o){case"price_desc":y="ListPrice desc";break;case"price_asc":y="ListPrice asc";break;case"newest":case"popular":y="ModificationTimestamp desc"}g.push("$orderby="+y);let P=`${process.env.MLS_API_URL}?${g.join("&")}`;console.log("MLS API Request URL:",P);let v=await p.Z.get(P,{headers:{Authorization:`Bearer ${process.env.MLS_ACCESS_TOKEN}`,Accept:"application/json"}});if(console.log("MLS API Response:",{total:v.data["@odata.count"],returned:v.data.value?.length}),!v.data||!Array.isArray(v.data.value))throw Error("Invalid response format from MLS API");let L=v.data.value.map(e=>({Id:e.ListingKey,ListPrice:e.ListPrice,Address:e.UnparsedAddress,City:e.City,Province:e.StateOrProvince,PostalCode:e.PostalCode,Bedrooms:e.BedroomsTotal,Bathrooms:e.BathroomsTotalInteger,LivingArea:e.LivingArea,PropertyType:e.PropertyType,ListingStatus:e.StandardStatus,Images:e.Media?.filter(e=>"Photo"===e.MediaType).map(e=>e.MediaURL)||[],Features:e.Features?.map(e=>e.FeatureName)||[]})),S=v.data["@odata.count"]||v.data.value.length;return n.Z.json({properties:L,total:S,page:r,pageSize:50,totalPages:Math.ceil(S/50)})}catch(e){return console.error("MLS API Error:",{message:e.message,status:e.response?.status,data:e.response?.data}),n.Z.json({error:"Failed to fetch MLS data",details:e.message},{status:e.response?.status||500})}}let h=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/mls/route",pathname:"/api/mls",filename:"route",bundlePath:"app/api/mls/route"},resolvedPagePath:"/Users/chakrinaidu/Desktop/Gethomerealty-production/app/api/mls/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:y,headerHooks:P,staticGenerationBailout:v}=h,L="/api/mls/route";function S(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1638,6206,1185,3949],()=>r(98955));module.exports=a})();