"use strict";(()=>{var e={};e.id=8678,e.ids=[8678],e.modules={38013:e=>{e.exports=require("mongodb")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},74924:(e,t,o)=>{o.r(t),o.d(t,{headerHooks:()=>w,originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>I,routeModule:()=>f,serverHooks:()=>v,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var a={};o.r(a),o.d(a,{DELETE:()=>p,GET:()=>c,PUT:()=>u});var r=o(95419),n=o(69108),d=o(99678),l=o(78070),s=o(22345),i=o(38013);async function c(e,{params:t}){try{let{db:e}=await (0,s.v)();console.log("Searching for lead with ID:",t.leadId);let o=null;try{let a=new i.ObjectId(t.leadId);o=await e.collection("leads").findOne({_id:a})}catch(a){console.log("Invalid ObjectId format:",a),o=await e.collection("leads").findOne({_id:t.leadId})}if(!o)return console.log("No lead found with ID:",t.leadId),l.Z.json({error:"Lead not found"},{status:404});return console.log("Found lead:",o),l.Z.json(o)}catch(e){return console.error("Fetch lead error:",e),l.Z.json({error:"Failed to fetch lead"},{status:500})}}async function u(e,{params:t}){try{let{db:o}=await (0,s.v)(),a=await e.json(),r=null;try{let e=new i.ObjectId(t.leadId);r=await o.collection("leads").findOneAndUpdate({_id:e},{$set:a},{returnDocument:"after"})}catch(e){console.log("Invalid ObjectId format:",e),r=await o.collection("leads").findOneAndUpdate({_id:t.leadId},{$set:a},{returnDocument:"after"})}if(!r?.value)return l.Z.json({error:"Lead not found"},{status:404});return l.Z.json(r.value)}catch(e){return console.error("Update lead error:",e),l.Z.json({error:"Failed to update lead"},{status:500})}}async function p(e,{params:t}){try{let{db:e}=await (0,s.v)(),o=null;try{let a=new i.ObjectId(t.leadId);o=await e.collection("leads").findOneAndDelete({_id:a})}catch(a){console.log("Invalid ObjectId format:",a),o=await e.collection("leads").findOneAndDelete({_id:t.leadId})}if(!o?.value)return l.Z.json({error:"Lead not found"},{status:404});return l.Z.json({message:"Lead deleted successfully"})}catch(e){return console.error("Delete lead error:",e),l.Z.json({error:"Failed to delete lead"},{status:500})}}let f=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/leads/[leadId]/route",pathname:"/api/leads/[leadId]",filename:"route",bundlePath:"app/api/leads/[leadId]/route"},resolvedPagePath:"/Users/chakrinaidu/Desktop/Gethomerealty-production/app/api/leads/[leadId]/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:I,staticGenerationAsyncStorage:h,serverHooks:v,headerHooks:w,staticGenerationBailout:m}=f,g="/api/leads/[leadId]/route";function j(){return(0,d.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:h})}},22345:(e,t,o)=>{let a;o.d(t,{v:()=>d});var r=o(38013);if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");let n=process.env.MONGODB_URI;async function d(){try{let e=await a;return{db:e.db(),client:e}}catch(e){throw console.error("MongoDB connection error:",e),e}}a=new r.MongoClient(n,{connectTimeoutMS:1e4,socketTimeoutMS:45e3,serverSelectionTimeoutMS:5e3,maxPoolSize:10,retryWrites:!0,retryReads:!0}).connect()}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),a=t.X(0,[1638,6206],()=>o(74924));module.exports=a})();