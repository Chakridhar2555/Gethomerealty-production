"use strict";(()=>{var e={};e.id=1262,e.ids=[1262],e.modules={38013:e=>{e.exports=require("mongodb")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7492:(e,o,t)=>{t.r(o),t.d(o,{headerHooks:()=>w,originalPathname:()=>m,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>g});var r={};t.r(r),t.d(r,{POST:()=>c});var a=t(95419),i=t(69108),n=t(99678),s=t(78070),l=t(22345);async function c(e){try{let o=await e.formData(),t=o.get("CallSid"),r=o.get("CallStatus"),a=o.get("CallDuration"),i=o.get("RecordingUrl"),{db:n}=await (0,l.v)();return await n.collection("leads").updateOne({"callHistory.twilioCallSid":t},{$set:{"callHistory.$.duration":parseInt(a)||0,"callHistory.$.recording":i,"callHistory.$.status":r}}),s.Z.json({success:!0})}catch(e){return console.error("Webhook error:",e),s.Z.json({error:"Webhook processing failed"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/twilio/webhook/route",pathname:"/api/twilio/webhook",filename:"route",bundlePath:"app/api/twilio/webhook/route"},resolvedPagePath:"/Users/chakrinaidu/Desktop/Gethomerealty-production/app/api/twilio/webhook/route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:p,serverHooks:h,headerHooks:w,staticGenerationBailout:g}=u,m="/api/twilio/webhook/route";function v(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}},22345:(e,o,t)=>{let r;t.d(o,{v:()=>n});var a=t(38013);if(!process.env.MONGODB_URI)throw Error("Please add your Mongo URI to .env.local");let i=process.env.MONGODB_URI;async function n(){try{let e=await r;return{db:e.db(),client:e}}catch(e){throw console.error("MongoDB connection error:",e),e}}r=new a.MongoClient(i,{connectTimeoutMS:1e4,socketTimeoutMS:45e3,serverSelectionTimeoutMS:5e3,maxPoolSize:10,retryWrites:!0,retryReads:!0}).connect()}};var o=require("../../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),r=o.X(0,[1638,6206],()=>t(7492));module.exports=r})();